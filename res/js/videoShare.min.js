!function(e,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var t,a=i();for(t in a)("object"==typeof exports?exports:e)[t]=a[t]}}(this,function(){return a={},o.m=t={4:function(e,i){new Vue({el:"#videoShareApp",data:function(){return{stream:null,times:0,interverlId:0,track:null}},methods:{getMediaPlay:function(){let e=null;return window.navigator.getDisplayMedia?e=window.navigator.getDisplayMedia({video:!0,audio:!0}):window.navigator.mediaDevices&&window.navigator.mediaDevices.getDisplayMedia?e=window.navigator.mediaDevices.getDisplayMedia({video:!0,audio:!0}):window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia?e=window.navigator.mediaDevices.getUserMedia({video:{mediaSource:"screen"},audio:!0}):window.navigator.mozGetUserMedia?e=navagator.mozGetUserMedia({video:!0,audio:!0}):window.navigator.getUserMedia?e=window.navigator.getUserMedia({video:!0,audio:!0}):window.navigator.webkitGetUserMedia&&(e=new Promise((i,t)=>{window.navigator.webkitGetUserMedia({video:!0,audio:!0},e=>{i(e)},e=>{t(e)})})),e},startVideoShare:async function(e,i){let t=this;if(null==this.stream)try{this.stream=await this.getMediaPlay()}catch(e){console.log(e),e.message}if(null==this.stream)return window.layer&&layer.msg("获取设备权限失败"),window.Bus.$emit("changeVideoShareState",!1),void(i&&i());$("#mediaShareRoomList").append(`
              <div class="swiper-slide mediaShareBlock">
                  <video id="selfMediaShareVideo" autoplay playsinline onclick="tlrtcfile.openFullVideo(this, 'video')"></video>
              </div>
            `);var a=document.querySelector("#selfMediaShareVideo");a.srcObject=this.stream,a.play(),document.addEventListener("WeixinJSBridgeReady",function(){a.play()},!1),this.interverlId=setInterval(()=>{t.times+=1,window.Bus.$emit("changeVideoShareTimes",t.times),$("#videoShare").css("fill","#fb0404"),setTimeout(()=>{$("#videoShare").css("fill","#000000")},500)},1e3),window.layer&&layer.msg("开始音视频通话，再次点击按钮即可挂断"),this.stream.getTracks().forEach(function(e){t.track=e,i&&i(e,t.stream)})},stopVideoShare:function(){this.stream&&this.stream.getTracks().forEach(e=>e.stop()),clearInterval(this.interverlId),window.Bus.$emit("changeVideoShareTimes",0),window.layer&&layer.msg("音视频通话结束，本次通话时长 "+this.times+"秒"),this.stream=null,this.times=0},getVideoShareTrackAndStream:function(e){e(this.track,this.stream)}},mounted:function(){window.Bus.$on("startVideoShare",this.startVideoShare),window.Bus.$on("stopVideoShare",this.stopVideoShare),window.Bus.$on("getVideoShareTrackAndStream",this.getVideoShareTrackAndStream)}})}},o.c=a,o.d=function(e,i,t){o.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:t})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(i,e){if(1&e&&(i=o(i)),8&e)return i;if(4&e&&"object"==typeof i&&i&&i.__esModule)return i;var t=Object.create(null);if(o.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:i}),2&e&&"string"!=typeof i)for(var a in i)o.d(t,a,function(e){return i[e]}.bind(null,a));return t},o.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(i,"a",i),i},o.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},o.p="",o(o.s=4);function o(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var t,a});